"use strict";(self.webpackChunkmy_suitcase=self.webpackChunkmy_suitcase||[]).push([[401],{4938:(D,P,e)=>{e.d(P,{_:()=>T});var g=e(5879),c=e(9862),E=e(2079),r=e(7927),A=e(959),C=e(6124),m=e(553);var u=e(930);let T=(()=>{class l{constructor(i,t,a){this._http=i,this.localeId=t,this._sessionService=a,this.SAVE_SUITCASE_API=m.N.apiUrl+"suitcase/save",this.UPDATE_SUITCASE_API=m.N.apiUrl+"suitcase/update",this.RECOMMENDATIONS_SUITCASE_API=m.N.apiUrl+"suitcase/recommendations",this.SUITCASE_OVERVIEW_API=m.N.apiUrl+"suitcase/overview",this.SUITCASE_DETAIL_API=m.N.apiUrl+"suitcase/detail/",this.REMOVE_SUITCASE_API=m.N.apiUrl+"suitcase/remove"}saveSuitcase(i,t=!1){const a=new E.xQ,U=new c.aW("POST",t?this.UPDATE_SUITCASE_API:this.SAVE_SUITCASE_API,{suitcase:i},{reportProgress:!0});return this._http.request(U).pipe((0,r.b)(S=>(this.getEventMessage(S,i),S)),(0,A.Z)()).subscribe(S=>{this._currentSuitcase=S.body.response,console.log("Suitcase saved! ",S.body.response),a.next()},S=>{console.log("There was a problem at saving the suitcase: ",S),a.error(S)}),a}getEventMessage(i,t){switch(i.type){case c.dt.Sent:console.log(`Uploading file "${t.name}".`);break;case c.dt.UploadProgress:const a=Math.round(100*i.loaded/i.total);console.log(`File "${t.name}" is ${a}% uploaded.`);break;case c.dt.Response:console.log(`File "${t.name}" was completely uploaded!`);break;default:console.log(`File "${t.name}" surprising upload event: ${i.type}.`)}}setCurrentSuitcase(i){this._currentSuitcase=i}getCurrentSuitcase(){return this._currentSuitcase}fetchRecommendations(i,t,a){const h=new E.xQ;return this._http.post(this.RECOMMENDATIONS_SUITCASE_API,{options:i,pageNumber:t,limit:a}).pipe((0,C.U)(o=>(o.baby&&(o.baby.items=this._getTranslatedItems(o.baby.items)),o.beach&&(o.beach.items=this._getTranslatedItems(o.beach.items)),o.common&&(o.common.items=this._getTranslatedItems(o.common.items)),o.mountain&&(o.mountain.items=this._getTranslatedItems(o.mountain.items)),o.pet&&(o.pet.items=this._getTranslatedItems(o.pet.items)),o.sport&&(o.sport.items=this._getTranslatedItems(o.sport.items)),o))).subscribe(o=>{console.log("Recommendations retrieved",o),h.next(o)},o=>{console.log("There was a problem at retrieving the recommendations: ",o),h.error(o)}),h}_getTranslatedItems(i){return"en-US"!=this.localeId?i.map(t=>(t.name=t[this.localeId+"_name"]||t.name,t)):i}retrieveSuitcaseOverview(i){const t=new E.xQ;return this._http.post(this.SUITCASE_OVERVIEW_API,i).subscribe(a=>{console.log("Suitcase overview retrieved",a),this.totalSuitcases=a.list.length,t.next(a)},a=>{console.log("There was a problem at retrieving the overview: ",a),t.error(a)}),t}removeSuitcase(i){const t=new E.xQ;return this._http.post(this.REMOVE_SUITCASE_API,{id:i}).subscribe(a=>{console.log("Suitcase removed",a),this.totalSuitcases--,t.next(a)},a=>{console.log("There was a problem at removing the suitcase: ",a),t.error(a)}),t}retrieveSuitcaseDetail(i){const t=new E.xQ,a=new c.WM({Authorization:`Bearer ${this._sessionService.getToken()}`});return this._http.get(this.SUITCASE_DETAIL_API+i,{headers:a}).subscribe(h=>{console.log("Suitcase detail retrieved",h),t.next(h),t.complete()},h=>{console.log("There was a problem at retrieving the detail of the suitcase: ",h),t.error(h)}),t}}return l.\u0275fac=function(i){return new(i||l)(g.LFG(c.eN),g.LFG(g.soG),g.LFG(u.m,8))},l.\u0275prov=g.Yz7({token:l,factory:l.\u0275fac}),l})()},1401:(D,P,e)=>{e.r(P),e.d(P,{PublicModule:()=>y});var g=e(1782),c=e(8006),E=e(6133),r=e(5879),A=e(1508),C=e(930),m=e(9347);let p=(()=>{class s{constructor(n,v,I,M){this._loginService=n,this._sessionService=v,this._elementRef=I,this._dialog=M}ngAfterViewInit(){let n=!1;this._sessionService.showTimeOutPopUp$.subscribe(()=>{n=!0;const v=this._dialog.open(E.e,{height:"200px",width:"400px",hasBackdrop:!0});v.afterClosed().subscribe(I=>{I||void 0===I?this.keepAlive():this.logout(),v.close(),n=!1})}),this._sessionService.logout$.subscribe(()=>{this._dialog.closeAll()}),this._elementRef.nativeElement.addEventListener("mousemove",v=>{n||this._sessionService.reset()}),this._elementRef.nativeElement.addEventListener("click",v=>{n||this._sessionService.reset()}),window.addEventListener("keypress",v=>{console.log("keypress"),n||this._sessionService.reset()})}keepAlive(){this._sessionService.reset()}logout(){this._sessionService.stopInterval(),this._loginService.logout()}}return s.\u0275fac=function(n){return new(n||s)(r.Y36(A.r),r.Y36(C.m),r.Y36(r.SBq),r.Y36(m.uw))},s.\u0275cmp=r.Xpm({type:s,selectors:[["app-public"]],decls:1,vars:0,template:function(n,v){1&n&&r._UZ(0,"router-outlet")},dependencies:[c.lC],styles:["[_nghost-%COMP%]{display:inline-block;width:100%;height:100%}"]}),s})();var u=e(9193),T=e(7927),l=e(6124),d=e(2413),i=e(9862),t=e(4938);let a=(()=>{class s{constructor(n,v,I){this._http=n,this._router=v,this._suitcaseService=I}resolve(n,v){const I=n.url[n.url.length-1].path;return n.url[n.url.length-1].path=this._removeSpaces(n.url[n.url.length-1].path),this._router.getCurrentNavigation().extras.state&&this._router.getCurrentNavigation().extras.state.id?(0,u.of)(!0):this._suitcaseService.retrieveSuitcaseDetail(I).pipe((0,T.b)(M=>this._suitcaseService.setCurrentSuitcase(M)),(0,l.U)(()=>!0),(0,d.K)(M=>(0,u.of)(!1)))}_removeSpaces(n){return n.split(" ").join("_").toLowerCase()}}return s.\u0275fac=function(n){return new(n||s)(r.LFG(i.eN),r.LFG(c.F0),r.LFG(t._))},s.\u0275prov=r.Yz7({token:s,factory:s.\u0275fac}),s})();const h=[{path:"",component:p,children:[{path:"home",loadChildren:()=>Promise.all([e.e(750),e.e(909),e.e(592),e.e(130)]).then(e.bind(e,6130)).then(s=>s.HomeModule)},{path:"create-suitcase",data:{createMode:!0},loadChildren:()=>Promise.all([e.e(750),e.e(909),e.e(791)]).then(e.bind(e,8791)).then(s=>s.CreateSuitcaseModule)},{path:"edit-suitcase/:name",resolve:{detail:a},data:{createMode:!1},loadChildren:()=>Promise.all([e.e(750),e.e(909),e.e(791)]).then(e.bind(e,8791)).then(s=>s.CreateSuitcaseModule)},{path:"contact",loadChildren:()=>Promise.all([e.e(750),e.e(435)]).then(e.bind(e,6435)).then(s=>s.ContactModule)},{path:"",redirectTo:"home",pathMatch:"full"}]}];let o=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=r.oAB({type:s}),s.\u0275inj=r.cJS({imports:[c.Bz.forChild(h),c.Bz]}),s})();var U=e(8185),S=e(4973),R=e(5319),O=e(1578);let y=(()=>{class s{constructor(){}}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=r.oAB({type:s}),s.\u0275inj=r.cJS({providers:[A.r,t._,a,O.T,S.Q,R.N],imports:[g.m,U._.forRoot({MINUTES_TO_SHOW_COUNTDOWN:10}),o]}),s})()},1578:(D,P,e)=>{e.d(P,{T:()=>p});var g=e(2079),c=e(553),E=e(1543),r=e(5879),A=e(9862),C=e(8322);let p=(()=>{class u{constructor(l,d){this._http=l,this._swPush=d,this.ADD_SUBSCRIBER_API=c.N.apiUrl+"notifications/subscribe"}subscribeNotifications(){const l=new g.xQ;return this._swPush.isEnabled?this._swPush.requestSubscription({serverPublicKey:"BN_Vaz62gKS1Mi6YS-6guChhEdg8J14bupDKzgh2rgeIcTwmGiDiblm96Emmkzlbakhk8Cy5sylcII65gVfHD7E"}).then(d=>{console.log("Notification subscription: ",d),this._http.post(this.ADD_SUBSCRIBER_API,d).subscribe(t=>{l.next(t)},t=>{l.error(t)})}).catch(d=>{console.error("Could not subscribe to notifications",d),l.error(d)}):l.error(E.b.NOTIFICATIONS_DISABLED),l}}return u.\u0275fac=function(l){return new(l||u)(r.LFG(A.eN),r.LFG(C.Mk))},u.\u0275prov=r.Yz7({token:u,factory:u.\u0275fac}),u})()}}]);